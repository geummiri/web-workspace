<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="studentMapper">
 
<!-- 
	resultMap에서 TB_STUDENT, TB_DEPARTMENT
	id, result < 앞에서 배운 건 여기까지였다면
	<association property="department"  resultMap="departmentMap/>
	
	showStudent
	
 -->
<resultMap type="Student" id="studentMapper">
		 <id property="studentNo" column="student_no"/>
		 <result property="departmentNo" column="department_no"/>
		 <result property="studentName" column="student_name"/>
		 <result property="studentAddress" column="student_address"/>
		<association property="department"  resultMap="departmentMap"/>
</resultMap>

 <resultMap type="Department" id="departmentMap">
 		 <id property="departmentNo" column="department_no"/>
		 <result property="departmentName" column="department_name"/>
		 <result property="category" column="category"/>
</resultMap>

<!-- SELECT * FROM 테이블1
INNER JOIN 테이블2 ON 테이블1.열 = 테이블2.열; -->

	
<select id="showStudent" resultType="Student" parameterType="String">
SELECT student_no, student_name, student_address, department_name, category
FROM tb_student
INNER JOIN tb_department ON tb_student.department_no = tb_department.department_no;

<trim prefix="WHERE" prefixOverrides="OR">
		 <if test="student_no != null">
				 student_name LIKE '%'||#{student_no}||'%'
			</if>
			
			<if test="student_name != null">
				student_name LIKE '%'||#{student_name}||'%'
			</if>
			
			<if test="student_address != null">
				student_address LIKE '%'||#{student_address}||'%'
			</if>
			
			<if test="department_name != null">
				department_name LIKE '%'||#{department_name}||'%'
			</if>
			
			<if test="category != null">
				category LIKE '%'||#{category}||'%'
			</if>
		</trim>
</select>

<!--  #{word} : 조건 - word가 null인지 아닌지
	WHERE student_no, student_name, student_address, department_name, category
	랑 WORD가 포함되어 있는지 
	이 중 하나만 걸려도 되니까 OR로 처리하기
	-->

</mapper>